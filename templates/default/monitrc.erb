set daemon <%= node["monit"]["poll_period"] %>
    with start delay <%= node["monit"]["poll_start_delay"] %>

set logfile syslog facility log_daemon

set mailserver <%= node["monit"]["mail_server"] %>

set eventqueue
    basedir <%= node["monit"]["basedir"] %>  # set the base directory where events will be stored
    slots <%= node["monit"]["slots"] %>      # optionaly limit the queue size

set mail-format { 
    from: <%= node["monit"]["mail_format"]["from"] %>
    subject: <%= node["monit"]["mail_format"]["subject"] %>
    message: <%= node["monit"]["mail_format"]["message"] %>
}

set alert <%= node["monit"]["notify_email"] %> NOT ON { action, instance, pid, ppid }

set httpd port <%= node["monit"]["port"] %> <% unless node["monit"]["listen"] == "all" %><%= "and\n    use address #{node["monit"]["listen"]}" %><% end %>
<% node["monit"]["allow"].each do |a| %>    allow <%= "#{a}\n" %><% end %>

include /etc/monit/conf.d/*.conf

